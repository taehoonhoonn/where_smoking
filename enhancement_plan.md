# 검색 기능 개선 계획

## 1. 검색 후 줌 레벨 확대
**현재 문제**: 검색 후 지도 이동 시 동일한 줌 레벨에서 이동되어 정확한 위치 파악이 어려움

**개선 방안**:
- 검색 결과로 이동 시 줌 레벨을 17-18로 확대
- 네이버 지도 API의 `setZoom()` 메서드 활용
- `app/lib/map_screen.dart`의 검색 결과 이동 함수에 줌 레벨 설정 추가

**구현 위치**: `app/web/flutter_marker_renderer.js`의 지도 이동 함수

## 2. 검색 후 이동 시 흡연장소 등록 확인 버튼 비활성화
**현재 문제**: 검색 후 이동된 위치에서 흡연장소 등록 확인 버튼이 출력됨

**개선 방안**:
- 검색으로 인한 이동과 사용자 직접 클릭을 구분하는 플래그 추가
- 검색 이동 시에는 등록 버튼 표시하지 않음
- 사용자가 의도적으로 길게 누른 경우에만 등록 버튼 활성화

**구현 위치**:
- `app/lib/map_screen.dart`의 이벤트 처리 로직 수정
- 검색 이동 상태를 추적하는 변수 추가

## 3. 검색 후 임시 위치 핀 생성
**현재 문제**: 검색된 위치를 시각적으로 표시할 방법이 없음

**개선 방안**:
- 검색된 위치에 임시 핀(마커) 생성
- 기존 흡연장소 마커와 구별되는 디자인 (예: 빨간색 핀, 다른 아이콘)
- 임시 핀 제거 시점 옵션:
  1. **권장**: 다음 검색 시 이전 검색 핀 제거 (가장 직관적)
  2. 사용자가 다른 위치를 클릭/터치할 때 제거
  3. 30초 후 자동 제거 (타이머)
  4. 앱 백그라운드 진입 시 제거

**구현 위치**:
- `app/web/flutter_marker_renderer.js`에 임시 마커 생성/제거 함수 추가
- `app/lib/map_screen.dart`에 검색 상태 관리 로직 추가

## 4. 배포 시 로컬 API 서버 관련 고려사항

**현재 상황 분석**:
- 개발 환경에서 API 서버가 로컬(localhost:3000)로 구성됨
- `app/lib/config.dart`와 `app/web/config.js`에서 API 베이스 URL 관리

**배포 시 필요 작업**:
1. **API 서버 호스팅**:
   - Google Cloud Run, AWS ECS, 또는 VPS에 API 서버 배포
   - 배포된 서버의 실제 URL로 API_BASE_URL 변경

2. **환경별 설정 분리**:
   - 개발/운영 환경별 config 파일 분리
   - Flutter 웹 빌드 시 환경변수로 API URL 주입

3. **CORS 설정 업데이트**:
   - `api_server/.env`의 CORS_ORIGINS에 실제 배포 도메인 추가
   - 보안을 위해 와일드카드(*) 대신 특정 도메인 지정

4. **데이터베이스 연결**:
   - 로컬 PostgreSQL 대신 클라우드 데이터베이스 사용
   - 연결 문자열 및 인증 정보 업데이트

**누락 가능성**:
- 현재 구조상 설정 파일만 올바르게 수정하면 배포 시 문제없음
- 단, API 서버와 데이터베이스 호스팅이 별도로 필요

## 구현 우선순위
1. **High**: 줌 레벨 확대 (사용성에 직접적 영향)
2. **Medium**: 임시 위치 핀 생성 (시각적 개선)
3. **Low**: 등록 버튼 비활성화 (현재도 사용 가능하므로 급하지 않음)